<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="0xKowalski">
    <title>PasswordStore Security Review</title>
    
    <style>
        body {
            font-family: 'Helvetica', 'Arial', sans-serif;
        }

        header {
            text-align: center;
        }
        
        nav, header {
            page-break-after: always;
        }

        header h1, header h2, header p {
            margin: 0;
            padding: 20px 0;
        }

        pre {
            font-family: monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        nav {
            font-size: 16px;
        }

        @media print {
            nav, <ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a>
<ul>
<li><a href="#about-0xkowalski" id="toc-about-0xkowalski">About
0xKowalski</a></li>
<li><a href="#disclaimer" id="toc-disclaimer">Disclaimer</a></li>
</ul></li>
<li><a href="#risk-classification" id="toc-risk-classification">Risk
Classification</a>
<ul>
<li><a href="#overview" id="toc-overview">Overview</a></li>
<li><a href="#severity-levels" id="toc-severity-levels">Severity
Levels</a></li>
</ul></li>
<li><a href="#protocol-summary" id="toc-protocol-summary">Protocol
Summary</a>
<ul>
<li><a href="#overview-1" id="toc-overview-1">Overview</a></li>
<li><a href="#scope" id="toc-scope">Scope</a></li>
<li><a href="#issues-found" id="toc-issues-found">Issues found</a></li>
</ul></li>
<li><a href="#findings" id="toc-findings">Findings</a>
<ul>
<li><a href="#high-severity-findings"
id="toc-high-severity-findings">High Severity Findings</a>
<ul>
<li><a
href="#h-1-secret-s_password-is-stored-on-chain-and-visible-to-anyone"
id="toc-h-1-secret-s_password-is-stored-on-chain-and-visible-to-anyone">[H-1]
Secret <code>s_password</code> is stored on chain and visible to
anyone</a></li>
<li><a
href="#h-2-setpassword-has-no-access-control-allowing-non-owner-to-set-the-password"
id="toc-h-2-setpassword-has-no-access-control-allowing-non-owner-to-set-the-password">[H-2]
<code>setPassword()</code> has no access control, allowing non-owner to
set the password</a></li>
</ul></li>
<li><a href="#informational-findings"
id="toc-informational-findings">Informational Findings</a>
<ul>
<li><a
href="#i-1-the-getpassword-natspec-includes-a-incorrect-parameter"
id="toc-i-1-the-getpassword-natspec-includes-a-incorrect-parameter">[I-1]
The <code>getPassword()</code> natspec includes a incorrect
parameter</a></li>
</ul></li>
</ul></li>
</ul> {
                page-break-before: always;
            }
        }
    </style>
</head>
<body>
    <header>
        <pre>
 ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣀⣤⣤⣤⣤⣤⣄⣀⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣤⣶⡿⠟⠛⠛⠉⠁⠀⠀⠈⠉⠙⠛⠻⢿⣷⣦⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣴⡿⠟⠉⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⠻⢿⣦⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣴⡿⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠹⣿⣦⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣰⣿⠟⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢿⣷⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣴⡿⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠹⣷⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣰⣿⠁⠀⠀⠀⠀⠀⠀⠀⢀⣠⣤⣶⣶⣤⣄⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣠⣤⣤⣹⣿⡄⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⡇⠀⠀⠀⠀⠀⠀⢀⣶⡿⠟⠉⠉⠉⠉⠉⠛⢿⣶⣄⠀⠀⠀⠀⠀⠀⠀⣴⡿⠛⠉⠉⠻⣿⣷⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⣿⠀⠀⠀⠀⠀⠀⣰⣿⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⢿⣦⠀⠀⠀⠀⠀⢰⣿⠃⠀⠀⠀⠀⠸⣿⡆⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⠀⠀⠀⠀⠀⢠⣿⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢿⣧⣀⣀⣤⣄⣺⣧⠀⢠⣤⣶⣤⡀⢻⣿⡀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⠀⠀⠀⠀⠀⣿⠇⠀⠀⠀⠀⠀⠀⢰⣾⢻⣿⣦⠀⠀⣼⡿⠟⠛⠉⠙⠛⢿⣦⡸⣶⣿⣿⠃⠀⣿⣷⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⠀⠀⠀⠀⢰⣿⠀⠀⠀⠀⠀⠀⠀⠘⢿⣿⣿⠟⠀⣼⣿⣀⠀⠀⠀⠀⠀⣀⣹⣷⠀⠀⠀⠀⠀⣿⣿⡇⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣿⠀⠀⠀⠀⠈⣿⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠸⣿⣿⣛⡳⠶⣖⣻⣿⡿⠃⠀⠀⠀⢀⣼⣿⣿⠁⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣸⡟⠀⠀⠀⠀⠀⠻⣷⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠉⠛⠛⠛⠛⠋⠁⠀⠀⠀⠀⣠⣾⠏⢻⣧⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⢰⣿⠇⠀⠀⠀⠀⠀⠀⠻⣷⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⣾⣿⣧⣄⠈⢿⣆⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⢠⣿⠏⠀⠀⠀⠀⠀⠀⠀⠀⠈⠻⢿⣦⣄⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⠛⠀⠉⠻⣷⡈⢿⣷⣄⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⣠⣿⠏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠛⣿⣿⠿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⣿⣆⠙⢿⣦⡀⠀
⠀⠀⠀⠀⠀⠀⣰⣿⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣀⣾⡟⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⣿⠂⠀⢻⣷⡄
⠀⠀⠀⠀⠀⣰⣿⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠛⠿⢿⣦⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣼⣿⠃⠀⠀⠀⢹⡇
⠀⠀⠀⠀⢰⣿⠇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⠻⣷⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⣿⠇⠀⠀⠀⠀⢸⣿
⠀⠀⠀⠀⣾⡟⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⢿⣧⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣾⣿⠀⠀⠀⠀⠀⣾⡏
⠀⠀⠀⢰⣿⠇⠀⠀⠀⠀⠀⠀⠀⠀⣄⣄⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢻⣧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⡇⠀⠀⠀⠀⣰⣿⠁
⠀⠀⠀⢸⣿⡀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠛⠿⣶⣄⡀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢿⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⡇⠀⠀⠀⣰⣿⠃⠀
⠀⠀⢀⣼⣿⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⣿⣿⣦⡀⠀⠀⠀⠀⠀⠀⠀⢸⣷⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⣧⣀⣴⣾⡟⠁⠀⠀
⢀⣴⣿⠟⢿⣇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⠇⠙⠿⣷⣄⡀⠀⠀⠀⠀⣼⡟⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⠿⠛⢻⣿⠁⠀⠀⠀
⢸⣿⠁⠀⠸⣿⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢰⣿⠀⠀⠀⠈⠻⢷⣦⣄⣀⣸⡿⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⣿⢿⣦⠀⠀⠀
⠸⣿⣷⡀⠀⠹⣿⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⣨⣿⣄⠀⠀⠀⠀⠀⠉⠉⠛⠋⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣿⠃⢸⣿⣤⣤⠀
⠀⠈⠛⠿⣷⣤⣝⣿⣦⡀⠀⠀⠀⢀⡀⢠⣾⡿⠛⠻⣿⣆⣴⡾⣶⣦⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣴⡿⠁⠀⠛⠛⢹⣿⠀
⠀⠀⠀⠀⠀⠉⠉⠛⠻⢿⣷⣄⠀⣿⡿⢿⡟⠀⠀⠀⠸⠿⠏⠀⠀⢹⣷⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣴⡿⠋⠀⠀⠀⣀⣴⡿⠋⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠻⣿⣿⣿⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⢨⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣶⣿⠋⠀⣀⣤⣴⡿⠟⠋⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠻⣷⣄⠀⠀⠀⠀⠀⠀⠀⣠⣿⠏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣠⣴⣿⠟⠛⠻⠿⠟⠛⠋⠁⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠻⣷⣦⣄⣀⣀⣠⣾⣿⣧⣤⣤⣤⣤⣤⣤⣤⣴⣶⠶⠿⠛⠉⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠉⠛⠛⠉⠉⠀⠉⠉⠉⠉⠉⠉⠉⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀

        </pre>

        <h1>PasswordStore Security Review</h1>
        <h2>Review completed by 0xKowalski</h2>
        <p>2024-03-24</p>
    </header>

        <nav>
        <h1>Table of Contents</h1>
        <ul>
        <li><a href="#introduction"
        id="toc-introduction">Introduction</a>
        <ul>
        <li><a href="#about-0xkowalski" id="toc-about-0xkowalski">About
        0xKowalski</a></li>
        <li><a href="#disclaimer"
        id="toc-disclaimer">Disclaimer</a></li>
        </ul></li>
        <li><a href="#risk-classification"
        id="toc-risk-classification">Risk Classification</a>
        <ul>
        <li><a href="#overview" id="toc-overview">Overview</a></li>
        <li><a href="#severity-levels" id="toc-severity-levels">Severity
        Levels</a></li>
        </ul></li>
        <li><a href="#protocol-summary"
        id="toc-protocol-summary">Protocol Summary</a>
        <ul>
        <li><a href="#overview-1" id="toc-overview-1">Overview</a></li>
        <li><a href="#scope" id="toc-scope">Scope</a></li>
        <li><a href="#issues-found" id="toc-issues-found">Issues
        found</a></li>
        </ul></li>
        <li><a href="#findings" id="toc-findings">Findings</a>
        <ul>
        <li><a href="#high-severity-findings"
        id="toc-high-severity-findings">High Severity Findings</a>
        <ul>
        <li><a
        href="#h-1-secret-s_password-is-stored-on-chain-and-visible-to-anyone"
        id="toc-h-1-secret-s_password-is-stored-on-chain-and-visible-to-anyone">[H-1]
        Secret <code>s_password</code> is stored on chain and visible to
        anyone</a></li>
        <li><a
        href="#h-2-setpassword-has-no-access-control-allowing-non-owner-to-set-the-password"
        id="toc-h-2-setpassword-has-no-access-control-allowing-non-owner-to-set-the-password">[H-2]
        <code>setPassword()</code> has no access control, allowing
        non-owner to set the password</a></li>
        </ul></li>
        <li><a href="#informational-findings"
        id="toc-informational-findings">Informational Findings</a>
        <ul>
        <li><a
        href="#i-1-the-getpassword-natspec-includes-a-incorrect-parameter"
        id="toc-i-1-the-getpassword-natspec-includes-a-incorrect-parameter">[I-1]
        The <code>getPassword()</code> natspec includes a incorrect
        parameter</a></li>
        </ul></li>
        </ul></li>
        </ul>
    </nav>
        <h2 id="introduction">Introduction</h2>
        <h3 id="about-0xkowalski">About 0xKowalski</h3>
        <p>I am 0xKowalski, a specialized Web3 security researcher with
        a focus on identifying and mitigating vulnerabilities in
        decentralized applications. With extensive experience in
        blockchain technology, my work encompasses the analysis of smart
        contracts, protocols, and DeFi platforms to enhance their
        security posture. My professional commitment is to safeguard the
        Web3 ecosystem, ensuring its integrity and reliability for users
        and stakeholders.</p>
        <p>You can find me at: - <a
        href="https://x.com/0xKowalski_">X</a> - <a
        href="https://github.com/0xKowalski1">Github</a></p>
        <h3 id="disclaimer">Disclaimer</h3>
        <p>I have exerted every effort to identify as many
        vulnerabilities as possible within the allocated time period.
        However, I do not bear responsibility for the findings detailed
        in this document. It’s important to note that a security audit
        does not serve as an endorsement of the underlying protocol.
        This audit was conducted within a specific timeframe, and the
        review focused exclusively on the security features of the
        Solidity implementation of the contracts.</p>
        <h2 id="risk-classification">Risk Classification</h2>
        <h3 id="overview">Overview</h3>
        <p>Risk classification for Web3 security findings involves
        evaluating the potential impact and likelihood of each
        vulnerability. This process helps in prioritizing responses
        based on the severity of the risk posed to the system.</p>
        <h3 id="severity-levels">Severity Levels</h3>
        <p>The severity of a finding is determined by assessing its
        impact and likelihood:</p>
        <table>
        <thead>
        <tr class="header">
        <th></th>
        <th></th>
        <th>Impact</th>
        <th></th>
        <th></th>
        </tr>
        </thead>
        <tbody>
        <tr class="odd">
        <td></td>
        <td></td>
        <td>High</td>
        <td>Medium</td>
        <td>Low</td>
        </tr>
        <tr class="even">
        <td></td>
        <td>High</td>
        <td>H</td>
        <td>H/M</td>
        <td>M</td>
        </tr>
        <tr class="odd">
        <td>Likelihood</td>
        <td>Medium</td>
        <td>H/M</td>
        <td>M</td>
        <td>M/L</td>
        </tr>
        <tr class="even">
        <td></td>
        <td>Low</td>
        <td>M</td>
        <td>M/L</td>
        <td>L</td>
        </tr>
        </tbody>
        </table>
        <p>The combination of impact and likelihood helps in assigning a
        precise severity level to each finding, ensuring that the most
        serious vulnerabilities are prioritized and addressed swiftly to
        maintain the integrity and security of the system.</p>
        <p>Additionally, informational findings may be noted in this
        report to shed light on non-critical issues or good practices.
        They offer context and detail that can help improve system
        understanding and security posture, even though they don’t
        represent immediate threats.</p>
        <h2 id="protocol-summary">Protocol Summary</h2>
        <h3 id="overview-1">Overview</h3>
        <p><code>PasswordStore</code> is a smart contract application
        for storing a password. Users should be able to store a password
        and then retrieve it later. Others should not be able to access
        the password.</p>
        <h3 id="scope">Scope</h3>
        <table>
        <thead>
        <tr class="header">
        <th>Files</th>
        <th>nSloc</th>
        </tr>
        </thead>
        <tbody>
        <tr class="odd">
        <td><code>src/PasswordStore.sol</code></td>
        <td>20</td>
        </tr>
        </tbody>
        </table>
        <h3 id="issues-found">Issues found</h3>
        <table>
        <thead>
        <tr class="header">
        <th>Severity Level</th>
        <th>Number of Findings</th>
        </tr>
        </thead>
        <tbody>
        <tr class="odd">
        <td>High</td>
        <td>2</td>
        </tr>
        <tr class="even">
        <td>Medium</td>
        <td>0</td>
        </tr>
        <tr class="odd">
        <td>Low</td>
        <td>0</td>
        </tr>
        <tr class="even">
        <td>Informational</td>
        <td>1</td>
        </tr>
        </tbody>
        </table>
        <h2 id="findings">Findings</h2>
        <h3 id="high-severity-findings">High Severity Findings</h3>
        <h4
        id="h-1-secret-s_password-is-stored-on-chain-and-visible-to-anyone">[H-1]
        Secret <code>s_password</code> is stored on chain and visible to
        anyone</h4>
        <p><strong>Description</strong> The private variable
        <code>s_password</code> is intended to only be accessible to the
        owner of the contract through the <code>getPassword()</code>
        method, however all data submitted to the blockchain can be
        accessed by anyone.</p>
        <p><strong>Impact</strong> This allows anyone to read the
        password, breaking the functionality of the protocol and leaking
        sensitive information.</p>
        <p><strong>Proof of Concept</strong> The following proof of
        concept can be followed to confirm this issue, note you will
        need foundry.</p>
        <ol type="1">
        <li>Create a local blockchain using anvil</li>
        </ol>
        <div class="sourceCode" id="cb1"><pre
        class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> anvil</span></code></pre></div>
        <ol start="2" type="1">
        <li>Deploy the contract to the chain.</li>
        </ol>
        <div class="sourceCode" id="cb2"><pre
        class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> deploy</span></code></pre></div>
        <ol start="3" type="1">
        <li>Use cast to find the storage item at storage slot
        <code>1</code>.</li>
        </ol>
        <div class="sourceCode" id="cb3"><pre
        class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">cast</span> storage <span class="op">&lt;</span>CONTRACT_ADDRESS_HERE<span class="op">&gt;</span> 1 <span class="at">--rpc-url</span> http://127.0.0.1:8545</span></code></pre></div>
        <p>This will return a hex representation of the
        <code>s_password</code> secret.</p>
        <pre><code>0x6d7950617373776f726400000000000000000000000000000000000000000014</code></pre>
        <ol start="4" type="1">
        <li>Finally we can get the string representation of
        <code>s_password</code> using the following.</li>
        </ol>
        <div class="sourceCode" id="cb5"><pre
        class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">cast</span> parse-bytes32-string 0x6d7950617373776f726400000000000000000000000000000000000000000014</span></code></pre></div>
        <p>This will return the string representation of
        <code>s_password</code> which is:</p>
        <pre><code>myPassword</code></pre>
        <p><strong>Recommended Mitigation</strong> Due to this finding,
        the overall architecture of the contract should be rethought.
        You could encrypt the password offchain and then store the
        encrypted password onchain. However, the user would then need to
        remember a second password to decrypt the encrypted
        password.</p>
        <h4
        id="h-2-setpassword-has-no-access-control-allowing-non-owner-to-set-the-password">[H-2]
        <code>setPassword()</code> has no access control, allowing
        non-owner to set the password</h4>
        <p><strong>Description</strong> The <code>setPassword()</code>
        lacks access control, however, according to the natspec is
        should only be callable by the owner:
        <code>This function allows only the owner to set a new password.</code></p>
        <div class="sourceCode" id="cb7"><pre
        class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>@<span class="op">&gt;</span>    <span class="kw">function</span> <span class="fu">setPassword</span>(string memory newPassword) external { <span class="co">// @audit - There is no access control</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>          s_password <span class="op">=</span> newPassword<span class="op">;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>          emit <span class="fu">SetNetPassword</span>()<span class="op">;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>      }</span></code></pre></div>
        <p><strong>Impact</strong> This allows anyone to set the
        password, breaking the invariant that only the owner should be
        able to set the password.</p>
        <p><strong>Proof of Concept</strong> The following can be added
        to your test suite in <code>tests/PasswordStore.t.sol</code> to
        verify this issue:</p>
        <div class="sourceCode" id="cb8"><pre
        class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">test_non_owner_setting_password_reverts</span>() <span class="kw">public</span> {</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>        vm<span class="op">.</span><span class="fu">startPrank</span>(vm<span class="op">.</span><span class="fu">addr</span>(<span class="dv">1</span>))<span class="op">;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>        vm<span class="op">.</span><span class="fu">expectRevert</span>(PasswordStore<span class="op">.</span><span class="at">PasswordStore__NotOwner</span><span class="op">.</span><span class="at">selector</span>)<span class="op">;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>        passwordStore<span class="op">.</span><span class="fu">setPassword</span>(<span class="st">&quot;nonOwnerPassword&quot;</span>)<span class="op">;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div>
        <p>Now when running the test suite with <code>forge test</code>
        we get one failing test with the following output:</p>
        <pre><code>Failing tests:
Encountered 1 failing test in test/PasswordStore.t.sol:PasswordStoreTest
[FAIL. Reason: call did not revert as expected] test_non_owner_setting_password_reverts() (
gas: 15587)</code></pre>
        <p><strong>Recommended Mitigation</strong> Copy the access
        control check from <code>getPassword()</code> to
        <code>setPassword()</code> as follows:</p>
        <div class="sourceCode" id="cb10"><pre
        class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">setPassword</span>(string memory newPassword) external {</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="op">+</span>       <span class="cf">if</span> (msg<span class="op">.</span><span class="at">sender</span> <span class="op">!=</span> s_owner) {</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="op">+</span>           revert <span class="fu">PasswordStore__NotOwner</span>()<span class="op">;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="op">+</span>       }</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        s_password <span class="op">=</span> newPassword<span class="op">;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        emit <span class="fu">SetNetPassword</span>()<span class="op">;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div>
        <p>Once this is added, all tests, including the one added in the
        proof of concept, pass.</p>
        <h3 id="informational-findings">Informational Findings</h3>
        <h4
        id="i-1-the-getpassword-natspec-includes-a-incorrect-parameter">[I-1]
        The <code>getPassword()</code> natspec includes a incorrect
        parameter</h4>
        <p><strong>Description</strong> The natspec for
        <code>getPassword()</code> is incorrect as it states that the
        function takes <code>newPassword</code> as a parameter, which it
        does not, it takes no parameters.</p>
        <div class="sourceCode" id="cb11"><pre
        class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">/*</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">     * @notice This allows only the owner to retrieve the password.</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">@&gt;   * @param newPassword The new password to set.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">     */</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">getPassword</span>() external view <span class="fu">returns</span> (string memory) {</span></code></pre></div>
        <p><strong>Impact</strong> The natspec is incorrect.</p>
        <p><strong>Recommended Mitigation</strong> Remove the incorrect
        line from the natspec.</p>
        <div class="sourceCode" id="cb12"><pre
        class="sourceCode diff"><code class="sourceCode diff"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="st">-    * @param newPassword The new password to set.</span></span></code></pre></div>
</body>
</html>
